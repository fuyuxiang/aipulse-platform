2026-01-08 17:34:29,041 INFO     55 task_executor_06244a3777df_0 log path: /ragflow/logs/task_executor_06244a3777df_0.log, log levels: {'peewee': 'WARNING', 'pdfminer': 'WARNING', 'root': 'INFO'}
2026-01-08 17:34:29,041 INFO     55 Staggering startup by 0.03s to prevent connection storm
2026-01-08 17:34:29,070 INFO     55 
    ____                      __  _
   /  _/___  ____ ____  _____/ /_(_)___  ____     ________  ______   _____  _____
   / // __ \/ __ `/ _ \/ ___/ __/ / __ \/ __ \   / ___/ _ \/ ___/ | / / _ \/ ___/
 _/ // / / / /_/ /  __(__  ) /_/ / /_/ / / / /  (__  )  __/ /   | |/ /  __/ /
/___/_/ /_/\__, /\___/____/\__/_/\____/_/ /_/  /____/\___/_/    |___/\___/_/
          /____/
    
2026-01-08 17:34:29,070 INFO     55 RAGFlow version: v0.23.0
2026-01-08 17:34:29,070 INFO     55 Current configs, from /ragflow/conf/service_conf.yaml:
	ragflow: {'host': '0.0.0.0', 'http_port': 9380}
	admin: {'host': '0.0.0.0', 'http_port': 9381}
	mysql: {'name': 'rag_flow', 'user': 'root', 'password': '********', 'host': 'mysql', 'port': 3306, 'max_connections': 900, 'stale_timeout': 300, 'max_allowed_packet': 1073741824}
	minio: {'user': 'rag_flow', 'password': '********', 'host': 'docker-minio-1:9000', 'bucket': '', 'prefix_path': ''}
	es: {'hosts': 'http://es01:9200', 'username': 'elastic', 'password': '********'}
	os: {'hosts': 'http://opensearch01:9201', 'username': 'admin', 'password': '********'}
	infinity: {'uri': 'infinity:23817', 'db_name': 'default_db'}
	oceanbase: {'scheme': 'oceanbase', 'config': {'db_name': 'ragflow_doc', 'user': 'root@ragflow', 'password': 'infini_rag_flow', 'host': 'oceanbase', 'port': 2881}}
	redis: {'db': 1, 'username': '', 'password': '********', 'host': 'docker-redis-1:6379'}
	user_default_llm: {'default_models': {'embedding_model': {'api_key': 'xxx', 'base_url': 'http://tei:80'}}}
2026-01-08 17:34:29,072 WARNING  55 SECURITY WARNING: Using auto-generated SECRET_KEY.
2026-01-08 17:34:29,085 INFO     55 GET http://es01:9200/ [status:200 duration:0.011s]
2026-01-08 17:34:29,090 INFO     55 HEAD http://es01:9200/ [status:200 duration:0.004s]
2026-01-08 17:34:29,090 INFO     55 Use Elasticsearch http://es01:9200 as the doc engine.
2026-01-08 17:34:29,091 INFO     55 Elasticsearch http://es01:9200 is healthy.
2026-01-08 17:34:29,091 INFO     55 Use Elasticsearch http://es01:9200 as the doc engine.
2026-01-08 17:34:29,091 INFO     55 Elasticsearch http://es01:9200 is healthy.
2026-01-08 17:34:29,098 WARNING  55 Load term.freq FAIL!
2026-01-08 17:34:29,109 WARNING  55 Realtime synonym is disabled, since no redis connection.
2026-01-08 17:34:29,120 WARNING  55 Load term.freq FAIL!
2026-01-08 17:34:29,125 WARNING  55 Realtime synonym is disabled, since no redis connection.
2026-01-08 17:34:29,126 INFO     55 can't import package 'torch'
2026-01-08 17:34:29,126 INFO     55 default embedding config: {'model': '', 'factory': '', 'api_key': 'xxx', 'base_url': 'http://tei:80'}
2026-01-08 17:34:29,126 INFO     55 MAX_CONTENT_LENGTH: 134217728
2026-01-08 17:34:29,126 INFO     55 MAX_FILE_COUNT_PER_USER: 0
2026-01-08 17:34:29,128 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:34:29.127+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 5, "lag": 12, "done": 0, "failed": 0, "current": {}}
2026-01-08 17:34:29,129 INFO     55 task_executor_fd1177a5fee9_0 expired, removed
2026-01-08 17:34:29,228 INFO     55 handle_task begin for task {"id": "abdec33bec4311f092a6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 60000, "to_page": 63000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583926, "task_type": ""}
2026-01-08 17:34:29,539 INFO     55 HEAD http://es01:9200/ragflow_a557c21cec3a11f09e18ee27b281d736 [status:200 duration:0.004s]
2026-01-08 17:34:29,621 INFO     55 handle_task begin for task {"id": "abdec394ec4311f099f6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 63000, "to_page": 66000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583927, "task_type": ""}
2026-01-08 17:34:29,915 INFO     55 HEAD http://es01:9200/ragflow_a557c21cec3a11f09e18ee27b281d736 [status:200 duration:0.005s]
2026-01-08 17:34:30,022 INFO     55 handle_task begin for task {"id": "abdec3fdec4311f09a41469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 66000, "to_page": 69000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583928, "task_type": ""}
2026-01-08 17:34:30,328 INFO     55 HEAD http://es01:9200/ragflow_a557c21cec3a11f09e18ee27b281d736 [status:200 duration:0.006s]
2026-01-08 17:34:30,425 INFO     55 handle_task begin for task {"id": "abdec454ec4311f0b968469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 69000, "to_page": 72000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583929, "task_type": ""}
2026-01-08 17:34:30,713 INFO     55 HEAD http://es01:9200/ragflow_a557c21cec3a11f09e18ee27b281d736 [status:200 duration:0.005s]
2026-01-08 17:34:30,733 INFO     55 handle_task begin for task {"id": "abdec4b1ec4311f0a144469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 72000, "to_page": 75000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583930, "task_type": ""}
2026-01-08 17:34:31,008 INFO     55 HEAD http://es01:9200/ragflow_a557c21cec3a11f09e18ee27b281d736 [status:200 duration:0.006s]
2026-01-08 17:34:31,013 INFO     55 From minio(1.4741830760613084) dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv
2026-01-08 17:34:31,016 INFO     55 From minio(1.0998651878908277) dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv
2026-01-08 17:34:31,016 INFO     55 From minio(0.6876535778865218) dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv
2026-01-08 17:34:31,016 INFO     55 From minio(0.3032117383554578) dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv
2026-01-08 17:34:31,055 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.1, progress_msg: 17:34:31 Page(60001~63001): Start to parse.
2026-01-08 17:34:31,533 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.3, progress_msg: 17:34:31 Page(60001~63001): Extract records: 60000~63000
2026-01-08 17:34:31,675 INFO     55 From minio(0.6661843992769718) dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv
2026-01-08 17:34:59,224 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:34:59.163+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 10, "lag": 7, "done": 0, "failed": 0, "current": {"abdec33bec4311f092a6469b2e060af3": {"id": "abdec33bec4311f092a6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 60000, "to_page": 63000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583926, "task_type": ""}, "abdec394ec4311f099f6469b2e060af3": {"id": "abdec394ec4311f099f6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 63000, "to_page": 66000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583927, "task_type": ""}, "abdec3fdec4311f09a41469b2e060af3": {"id": "abdec3fdec4311f09a41469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 66000, "to_page": 69000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583928, "task_type": ""}, "abdec454ec4311f0b968469b2e060af3": {"id": "abdec454ec4311f0b968469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 69000, "to_page": 72000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583929, "task_type": ""}, "abdec4b1ec4311f0a144469b2e060af3": {"id": "abdec4b1ec4311f0a144469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 72000, "to_page": 75000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583930, "task_type": ""}}}
2026-01-08 17:35:04,197 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.35, progress_msg: 
2026-01-08 17:35:04,298 INFO     55 Chunking(34.75885118730366) dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv done
2026-01-08 17:35:04,397 INFO     55 MINIO PUT(dm_m_yx_prod_charge_info_hash-202511251514030511.csv) cost 0.099 s
2026-01-08 17:35:04,401 INFO     55 Build document dm_m_yx_prod_charge_info_hash-202511251514030511.csv: 34.86s
2026-01-08 17:35:04,411 INFO     55 set_progress(abdec394ec4311f099f6469b2e060af3), progress: 0.1, progress_msg: 17:35:04 Page(63001~66001): Start to parse.
2026-01-08 17:35:04,904 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: None, progress_msg: 17:35:04 Page(60001~63001): Generate 3000 chunks
2026-01-08 17:35:04,926 INFO     55 set_progress(abdec394ec4311f099f6469b2e060af3), progress: 0.3, progress_msg: 17:35:04 Page(63001~66001): Extract records: 63000~66000
2026-01-08 17:35:11,710 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.7000666666666666, progress_msg: 
2026-01-08 17:35:17,553 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.7011333333333333, progress_msg: 
2026-01-08 17:35:23,258 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.7021999999999999, progress_msg: 
2026-01-08 17:35:29,383 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:35:29.331+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 10, "lag": 7, "done": 0, "failed": 0, "current": {"abdec33bec4311f092a6469b2e060af3": {"id": "abdec33bec4311f092a6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 60000, "to_page": 63000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583926, "task_type": ""}, "abdec394ec4311f099f6469b2e060af3": {"id": "abdec394ec4311f099f6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 63000, "to_page": 66000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583927, "task_type": ""}, "abdec3fdec4311f09a41469b2e060af3": {"id": "abdec3fdec4311f09a41469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 66000, "to_page": 69000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583928, "task_type": ""}, "abdec454ec4311f0b968469b2e060af3": {"id": "abdec454ec4311f0b968469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 69000, "to_page": 72000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583929, "task_type": ""}, "abdec4b1ec4311f0a144469b2e060af3": {"id": "abdec4b1ec4311f0a144469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 72000, "to_page": 75000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583930, "task_type": ""}}}
2026-01-08 17:35:29,709 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.7032666666666666, progress_msg: 
2026-01-08 17:35:36,642 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.7043333333333333, progress_msg: 
2026-01-08 17:35:42,949 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.7053999999999999, progress_msg: 
2026-01-08 17:35:46,016 INFO     55 set_progress(abdec394ec4311f099f6469b2e060af3), progress: 0.35, progress_msg: 
2026-01-08 17:35:46,177 INFO     55 Chunking(76.26153608318418) dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv done
2026-01-08 17:35:46,267 INFO     55 MINIO PUT(dm_m_yx_prod_charge_info_hash-202511251514030511.csv) cost 0.089 s
2026-01-08 17:35:46,271 INFO     55 Build document dm_m_yx_prod_charge_info_hash-202511251514030511.csv: 76.36s
2026-01-08 17:35:46,282 INFO     55 set_progress(abdec3fdec4311f09a41469b2e060af3), progress: 0.1, progress_msg: 17:35:46 Page(66001~69001): Start to parse.
2026-01-08 17:35:46,876 INFO     55 set_progress(abdec394ec4311f099f6469b2e060af3), progress: None, progress_msg: 17:35:46 Page(63001~66001): Generate 3000 chunks
2026-01-08 17:35:46,897 INFO     55 set_progress(abdec3fdec4311f09a41469b2e060af3), progress: 0.3, progress_msg: 17:35:46 Page(66001~69001): Extract records: 66000~69000
2026-01-08 17:35:49,167 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.7064666666666666, progress_msg: 
2026-01-08 17:35:55,493 INFO     55 set_progress(abdec394ec4311f099f6469b2e060af3), progress: 0.7000666666666666, progress_msg: 
2026-01-08 17:35:59,522 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:35:59.466+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 10, "lag": 7, "done": 0, "failed": 0, "current": {"abdec33bec4311f092a6469b2e060af3": {"id": "abdec33bec4311f092a6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 60000, "to_page": 63000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583926, "task_type": ""}, "abdec394ec4311f099f6469b2e060af3": {"id": "abdec394ec4311f099f6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 63000, "to_page": 66000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583927, "task_type": ""}, "abdec3fdec4311f09a41469b2e060af3": {"id": "abdec3fdec4311f09a41469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 66000, "to_page": 69000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583928, "task_type": ""}, "abdec454ec4311f0b968469b2e060af3": {"id": "abdec454ec4311f0b968469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 69000, "to_page": 72000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583929, "task_type": ""}, "abdec4b1ec4311f0a144469b2e060af3": {"id": "abdec4b1ec4311f0a144469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 72000, "to_page": 75000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583930, "task_type": ""}}}
2026-01-08 17:36:01,899 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.7075333333333332, progress_msg: 
2026-01-08 17:36:08,187 INFO     55 set_progress(abdec394ec4311f099f6469b2e060af3), progress: 0.7011333333333333, progress_msg: 
2026-01-08 17:36:14,802 INFO     55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: 0.7086, progress_msg: 
2026-01-08 17:36:21,292 INFO     55 set_progress(abdec394ec4311f099f6469b2e060af3), progress: 0.7021999999999999, progress_msg: 
2026-01-08 17:36:28,134 ERROR    55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: -1, progress_msg: 17:36:27 Page(60001~63001): [ERROR]Generate embedding error:(2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1012, in do_handle_task
    token_count, vector_size = await embedding(chunks, embedding_model, task_parser_config, progress_callback)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 540, in embedding
    vts, c = await asyncio.to_thread(batch_encode, cnts[i : i + settings.EMBEDDING_BATCH_SIZE])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 58, in wrapper
    raise result
  File "/ragflow/common/connection_utils.py", line 42, in target
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 535, in batch_encode
    return mdl.encode([truncate(c, mdl.max_length-10) for c in txts])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/llm_service.py", line 111, in encode
    if not TenantLLMService.increase_usage(self.tenant_id, self.llm_type, used_tokens, llm_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:28,290 ERROR    55 Generate embedding error:(2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1012, in do_handle_task
    token_count, vector_size = await embedding(chunks, embedding_model, task_parser_config, progress_callback)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 540, in embedding
    vts, c = await asyncio.to_thread(batch_encode, cnts[i : i + settings.EMBEDDING_BATCH_SIZE])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 58, in wrapper
    raise result
  File "/ragflow/common/connection_utils.py", line 42, in target
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 535, in batch_encode
    return mdl.encode([truncate(c, mdl.max_length-10) for c in txts])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/llm_service.py", line 111, in encode
    if not TenantLLMService.increase_usage(self.tenant_id, self.llm_type, used_tokens, llm_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:28,508 ERROR    55 set_progress(abdec33bec4311f092a6469b2e060af3), progress: -1, progress_msg: 17:36:28 [ERROR][Exception]: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1012, in do_handle_task
    token_count, vector_size = await embedding(chunks, embedding_model, task_parser_config, progress_callback)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 540, in embedding
    vts, c = await asyncio.to_thread(batch_encode, cnts[i : i + settings.EMBEDDING_BATCH_SIZE])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 58, in wrapper
    raise result
  File "/ragflow/common/connection_utils.py", line 42, in target
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 535, in batch_encode
    return mdl.encode([truncate(c, mdl.max_length-10) for c in txts])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/llm_service.py", line 111, in encode
    if not TenantLLMService.increase_usage(self.tenant_id, self.llm_type, used_tokens, llm_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:28,670 ERROR    55 handle_task got exception for task {"id": "abdec33bec4311f092a6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 60000, "to_page": 63000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583926, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1012, in do_handle_task
    token_count, vector_size = await embedding(chunks, embedding_model, task_parser_config, progress_callback)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 540, in embedding
    vts, c = await asyncio.to_thread(batch_encode, cnts[i : i + settings.EMBEDDING_BATCH_SIZE])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 58, in wrapper
    raise result
  File "/ragflow/common/connection_utils.py", line 42, in target
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 535, in batch_encode
    return mdl.encode([truncate(c, mdl.max_length-10) for c in txts])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/llm_service.py", line 111, in encode
    if not TenantLLMService.increase_usage(self.tenant_id, self.llm_type, used_tokens, llm_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:29,815 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:36:29.750+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 1, "current": {"abdec394ec4311f099f6469b2e060af3": {"id": "abdec394ec4311f099f6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 63000, "to_page": 66000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583927, "task_type": ""}, "abdec3fdec4311f09a41469b2e060af3": {"id": "abdec3fdec4311f09a41469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 66000, "to_page": 69000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583928, "task_type": ""}, "abdec454ec4311f0b968469b2e060af3": {"id": "abdec454ec4311f0b968469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 69000, "to_page": 72000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583929, "task_type": ""}, "abdec4b1ec4311f0a144469b2e060af3": {"id": "abdec4b1ec4311f0a144469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 72000, "to_page": 75000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583930, "task_type": ""}}}
2026-01-08 17:36:29,907 ERROR    55 set_progress(abdec3fdec4311f09a41469b2e060af3), progress: -1, progress_msg: 17:36:29 Page(66001~69001): [ERROR]Internal server error while chunking: (2003, "Cant connect to MySQL server on mysql ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:29,916 ERROR    55 Chunking dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:29,931 ERROR    55 set_progress(abdec3fdec4311f09a41469b2e060af3), progress: -1, progress_msg: 17:36:29 [ERROR][Exception]: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1004, in do_handle_task
    chunks = await build_chunks(task, progress_callback)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:29,941 ERROR    55 handle_task got exception for task {"id": "abdec3fdec4311f09a41469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 66000, "to_page": 69000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583928, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1004, in do_handle_task
    chunks = await build_chunks(task, progress_callback)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:29,961 ERROR    55 set_progress(abdec454ec4311f0b968469b2e060af3), progress: 0.1, progress_msg: 17:36:29 Page(69001~72001): Start to parse., got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:30,470 ERROR    55 set_progress(abdec454ec4311f0b968469b2e060af3), progress: 0.3, progress_msg: 17:36:30 Page(69001~72001): Extract records: 69000~72000, got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:35,572 ERROR    55 set_progress(abdec394ec4311f099f6469b2e060af3), progress: -1, progress_msg: 17:36:35 Page(63001~66001): [ERROR]Generate embedding error:(2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1012, in do_handle_task
    token_count, vector_size = await embedding(chunks, embedding_model, task_parser_config, progress_callback)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 540, in embedding
    vts, c = await asyncio.to_thread(batch_encode, cnts[i : i + settings.EMBEDDING_BATCH_SIZE])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 58, in wrapper
    raise result
  File "/ragflow/common/connection_utils.py", line 42, in target
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 535, in batch_encode
    return mdl.encode([truncate(c, mdl.max_length-10) for c in txts])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/llm_service.py", line 111, in encode
    if not TenantLLMService.increase_usage(self.tenant_id, self.llm_type, used_tokens, llm_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:35,712 ERROR    55 Generate embedding error:(2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1012, in do_handle_task
    token_count, vector_size = await embedding(chunks, embedding_model, task_parser_config, progress_callback)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 540, in embedding
    vts, c = await asyncio.to_thread(batch_encode, cnts[i : i + settings.EMBEDDING_BATCH_SIZE])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 58, in wrapper
    raise result
  File "/ragflow/common/connection_utils.py", line 42, in target
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 535, in batch_encode
    return mdl.encode([truncate(c, mdl.max_length-10) for c in txts])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/llm_service.py", line 111, in encode
    if not TenantLLMService.increase_usage(self.tenant_id, self.llm_type, used_tokens, llm_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:35,901 ERROR    55 set_progress(abdec394ec4311f099f6469b2e060af3), progress: -1, progress_msg: 17:36:35 [ERROR][Exception]: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1012, in do_handle_task
    token_count, vector_size = await embedding(chunks, embedding_model, task_parser_config, progress_callback)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 540, in embedding
    vts, c = await asyncio.to_thread(batch_encode, cnts[i : i + settings.EMBEDDING_BATCH_SIZE])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 58, in wrapper
    raise result
  File "/ragflow/common/connection_utils.py", line 42, in target
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 535, in batch_encode
    return mdl.encode([truncate(c, mdl.max_length-10) for c in txts])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/llm_service.py", line 111, in encode
    if not TenantLLMService.increase_usage(self.tenant_id, self.llm_type, used_tokens, llm_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:36,002 ERROR    55 handle_task got exception for task {"id": "abdec394ec4311f099f6469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 63000, "to_page": 66000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583927, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1012, in do_handle_task
    token_count, vector_size = await embedding(chunks, embedding_model, task_parser_config, progress_callback)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 540, in embedding
    vts, c = await asyncio.to_thread(batch_encode, cnts[i : i + settings.EMBEDDING_BATCH_SIZE])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 58, in wrapper
    raise result
  File "/ragflow/common/connection_utils.py", line 42, in target
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 535, in batch_encode
    return mdl.encode([truncate(c, mdl.max_length-10) for c in txts])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/api/db/services/llm_service.py", line 111, in encode
    if not TenantLLMService.increase_usage(self.tenant_id, self.llm_type, used_tokens, llm_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:36:59,966 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:36:59.902+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 3, "current": {"abdec454ec4311f0b968469b2e060af3": {"id": "abdec454ec4311f0b968469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 69000, "to_page": 72000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583929, "task_type": ""}, "abdec4b1ec4311f0a144469b2e060af3": {"id": "abdec4b1ec4311f0a144469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 72000, "to_page": 75000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583930, "task_type": ""}}}
2026-01-08 17:37:04,656 ERROR    55 set_progress(abdec454ec4311f0b968469b2e060af3), progress: -1, progress_msg: 17:37:04 Page(69001~72001): [ERROR]Internal server error while chunking: (2003, "Cant connect to MySQL server on mysql ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:37:04,667 ERROR    55 Chunking dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:37:04,682 ERROR    55 set_progress(abdec454ec4311f0b968469b2e060af3), progress: -1, progress_msg: 17:37:04 [ERROR][Exception]: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1004, in do_handle_task
    chunks = await build_chunks(task, progress_callback)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:37:04,694 ERROR    55 handle_task got exception for task {"id": "abdec454ec4311f0b968469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 69000, "to_page": 72000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583929, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1004, in do_handle_task
    chunks = await build_chunks(task, progress_callback)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:37:04,711 ERROR    55 set_progress(abdec4b1ec4311f0a144469b2e060af3), progress: 0.1, progress_msg: 17:37:04 Page(72001~75001): Start to parse., got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:37:05,320 ERROR    55 set_progress(abdec4b1ec4311f0a144469b2e060af3), progress: 0.3, progress_msg: 17:37:05 Page(72001~75001): Extract records: 72000~75000, got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:37:30,108 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:37:30.054+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 4, "current": {"abdec4b1ec4311f0a144469b2e060af3": {"id": "abdec4b1ec4311f0a144469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 72000, "to_page": 75000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583930, "task_type": ""}}}
2026-01-08 17:37:39,596 ERROR    55 set_progress(abdec4b1ec4311f0a144469b2e060af3), progress: -1, progress_msg: 17:37:39 Page(72001~75001): [ERROR]Internal server error while chunking: (2003, "Cant connect to MySQL server on mysql ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:37:39,607 ERROR    55 Chunking dm_m_yx_prod_charge_info_hash-202511251514030511.csv/dm_m_yx_prod_charge_info_hash-202511251514030511.csv got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:37:39,618 ERROR    55 set_progress(abdec4b1ec4311f0a144469b2e060af3), progress: -1, progress_msg: 17:37:39 [ERROR][Exception]: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)"), got exception
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1004, in do_handle_task
    chunks = await build_chunks(task, progress_callback)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 152, in set_progress
    TaskService.update_progress(task_id, d)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:37:39,625 ERROR    55 handle_task got exception for task {"id": "abdec4b1ec4311f0a144469b2e060af3", "doc_id": "7aee492eec3f11f09fa51e34f4ba85d1", "from_page": 72000, "to_page": 75000, "retry_count": 0, "kb_id": "b25d4997ec3e11f08d66daadf0cde7a2", "parser_id": "table", "parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "task_page_size": 12, "entity_types": [], "pages": [[1, 1024]]}, "name": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "type": "doc", "location": "dm_m_yx_prod_charge_info_hash-202511251514030511.csv", "size": 28562435, "tenant_id": "a557c21cec3a11f09e18ee27b281d736", "language": "English", "embd_id": "bge-m3@Ollama", "pagerank": 0, "kb_parser_config": {"layout_recognize": "DeepDOC", "chunk_token_num": 512, "delimiter": "\n", "enable_children": false, "children_delimiter": "", "auto_keywords": 0, "auto_questions": 0, "html4excel": false, "topn_tags": 3, "toc_extraction": false, "image_table_context_window": 0, "overlapped_percent": 0, "mineru_parse_method": "auto", "mineru_formula_enable": true, "mineru_table_enable": true, "mineru_lang": "English", "raptor": {"use_raptor": true, "prompt": "\u8bf7\u603b\u7ed3\u4ee5\u4e0b\u6bb5\u843d\u3002 \u5c0f\u5fc3\u6570\u5b57\uff0c\u4e0d\u8981\u7f16\u9020\u3002 \u6bb5\u843d\u5982\u4e0b\uff1a\n      {cluster_content}\n\u4ee5\u4e0a\u5c31\u662f\u4f60\u9700\u8981\u603b\u7ed3\u7684\u5185\u5bb9\u3002", "max_token": 256, "threshold": 0.1, "max_cluster": 64, "random_seed": 0, "scope": "file"}, "graphrag": {"use_graphrag": true, "entity_types": ["organization", "person", "geo", "event", "category", "product"], "method": "light"}, "metadata": [], "enable_metadata": false, "llm_id": "deepseek-reasoner@DeepSeek", "image_context_size": 0, "table_context_size": 0, "field_map": {"product_id_long": "product id", "product_name_tks": "product name", "prov_name_tks": "prov name", "user_acct_cnt_long": "user acct cnt", "innet_type_tks": "innet type", "comp_type_tks": "comp type", "service_type_tks": "service type", "is_iot_kwd": "is iot", "is_ysh_kwd": "is ysh", "is_wlw_kwd": "is wlw", "is_hd_kwd": "is hd", "is_zhwq_kwd": "is zhwq", "is_up_999_kwd": "is up 999", "is_down_999_kwd": "is down 999", "original_fee_flt": "original fee", "a_discnt_long": "a discnt", "adjust_before_tks": "adjust before", "dxbk_fee_tks": "dxbk fee", "adjust_after_tks": "adjust after", "ftq_fee_flt": "ftq fee", "ftcl_fee_flt": "ftcl fee", "fth_fee_flt": "fth fee", "xzk_fee_tks": "xzk fee", "total_fee_flt": "total fee", "rsrv_val1_flt": "rsrv val1", "rsrv_val2_flt": "rsrv val2", "rsrv_val3_flt": "rsrv val3", "rsrv_val4_flt": "rsrv val4", "rsrv_val5_flt": "rsrv val5", "rsrv_val6_flt": "rsrv val6", "rsrv_val7_flt": "rsrv val7", "rsrv_val8_flt": "rsrv val8", "rsrv_val9_flt": "rsrv val9", "rsrv_val10_flt": "rsrv val10", "rsrv_dec1_tks": "rsrv dec1", "rsrv_dec2_tks": "rsrv dec2", "rsrv_dec3_tks": "rsrv dec3", "rsrv_dec4_tks": "rsrv dec4", "rsrv_dec5_tks": "rsrv dec5", "rsrv_dec6_flt": "rsrv dec6", "rsrv_dec7_tks": "rsrv dec7", "rsrv_dec8_flt": "rsrv dec8", "rsrv_dec9_tks": "rsrv dec9", "rsrv_dec10_flt": "rsrv dec10", "month_id_long": "month id", "a_discnt_flt": "a discnt", "ftcl_fee_tks": "ftcl fee", "rsrv_dec6_tks": "rsrv dec6", "rsrv_dec8_tks": "rsrv dec8", "rsrv_dec10_tks": "rsrv dec10", "is_up_999_flt": "is up 999", "is_down_999_flt": "is down 999", "a_discnt_tks": "a discnt", "fth_fee_tks": "fth fee", "total_fee_tks": "total fee"}}, "img2txt_id": "qwen3-vl-30b-a3b-thinking___OpenAI-API@OpenAI-API-Compatible", "asr_id": "", "llm_id": "deepseek-reasoner@DeepSeek", "update_time": 1767843583930, "task_type": ""}
Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 661, in connect
    sock = socket.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -3] Temporary failure in name resolution

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
pymysql.err.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/ragflow/rag/svr/task_executor.py", line 1101, in handle_task
    await do_handle_task(task)
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 1004, in do_handle_task
    chunks = await build_chunks(task, progress_callback)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/common/connection_utils.py", line 74, in async_wrapper
    return await func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/svr/task_executor.py", line 252, in build_chunks
    cks = await asyncio.to_thread(
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/futures.py", line 287, in __await__
    yield self  # This tells Task to wait for completion.
    ^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/tasks.py", line 385, in __wakeup
    future.result()
  File "/usr/lib/python3.12/asyncio/futures.py", line 203, in result
    raise self._exception.with_traceback(self._exception_tb)
  File "/usr/lib/python3.12/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/rag/app/table.py", line 471, in chunk
    KnowledgebaseService.update_parser_config(kwargs["kb_id"], {"field_map": {k: v for k, v in clmns_map}})
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3127, in inner
    with ConnectionContext(self.db):
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3122, in __enter__
    self.db.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 121, in connect
    return super(PooledDatabase, self).connect(reuse_if_open)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3231, in connect
    with __exception_wrapper__:
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3059, in __exit__
    reraise(new_type, new_type(exc_value, *exc_args), traceback)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 192, in reraise
    raise value.with_traceback(tb)
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 3232, in connect
    self._state.set_connection(self._connect())
                               ^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 76, in inner
    return fn(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/playhouse/pool.py", line 169, in _connect
    conn = super(PooledDatabase, self)._connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/peewee.py", line 4201, in _connect
    conn = mysql.connect(db=self.database, autocommit=True,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 365, in __init__
    self.connect()
  File "/ragflow/.venv/lib/python3.12/site-packages/pymysql/connections.py", line 723, in connect
    raise exc
peewee.OperationalError: (2003, "Can't connect to MySQL server on 'mysql' ([Errno -3] Temporary failure in name resolution)")
2026-01-08 17:38:00,194 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:38:00.193+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:38:30,200 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:38:30.198+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:39:00,205 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:39:00.203+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:39:30,208 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:39:30.207+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:40:00,213 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:40:00.212+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:40:30,218 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:40:30.217+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:41:00,222 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:41:00.221+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:41:30,226 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:41:30.225+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:42:00,230 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:42:00.228+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:42:30,236 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:42:30.235+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:43:00,239 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:43:00.238+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:43:30,244 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:43:30.243+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:44:00,248 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:44:00.247+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:44:30,253 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:44:30.251+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:45:00,257 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:45:00.256+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:45:30,261 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:45:30.260+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:46:00,265 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:46:00.264+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
2026-01-08 17:46:30,268 INFO     55 task_executor_06244a3777df_0 reported heartbeat: {"ip_address": "172.20.0.6", "pid": 55, "name": "task_executor_06244a3777df_0", "now": "2026-01-08T17:46:30.267+08:00", "boot_at": "2026-01-08T17:34:29.040+08:00", "pending": 17, "lag": 0, "done": 0, "failed": 5, "current": {}}
